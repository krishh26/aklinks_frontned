<div class="dashboard-container" [class.sidebar-closed]="!isSidebarOpen" [class]="currentTheme + '-theme'">
  <!-- Shared Sidebar -->
  <app-sidebar [isOpen]="isSidebarOpen" (sidebarToggle)="toggleSidebar()"></app-sidebar>

  <!-- Mobile Sidebar Overlay -->
  <div class="sidebar-overlay" *ngIf="isSidebarOpen" (click)="closeSidebar()"></div>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Admin Header -->
    <header class="admin-header">
      <div class="header-left">
        <button class="sidebar-toggle-header-btn" *ngIf="!isSidebarOpen" (click)="toggleSidebar()" title="Open Sidebar">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
      
      <div class="header-right">
        <div class="theme-switcher-wrapper">
          <button class="header-icon theme-toggle" (click)="toggleThemeDropdown()">
            <span>{{ getThemeIcon() }}</span>
          </button>
          <div class="theme-dropdown" [class.active]="isThemeDropdownOpen">
            <button 
              class="theme-option" 
              [class.active]="currentTheme === 'light'"
              (click)="selectTheme('light')">
              <span class="theme-icon">‚òÄÔ∏è</span>
              <span class="theme-label">Light</span>
            </button>
            <button 
              class="theme-option" 
              [class.active]="currentTheme === 'dark'"
              (click)="selectTheme('dark')">
              <span class="theme-icon">üåô</span>
              <span class="theme-label">Dark</span>
            </button>
            <button 
              class="theme-option" 
              [class.active]="currentTheme === 'blue'"
              (click)="selectTheme('blue')">
              <span class="theme-icon">üåä</span>
              <span class="theme-label">Blue</span>
            </button>
          </div>
        </div>
        <button class="header-icon notifications">
          <span>üîî</span>
          <span class="notification-badge">3</span>
        </button>
        <button class="header-icon profile">
          <span>üë§</span>
        </button>
      </div>
    </header>

    <!-- User List Content -->
    <section class="user-management">
      <!-- Breadcrumbs -->
      <nav class="breadcrumbs">
        <a routerLink="/admin/dashboard" class="breadcrumb-link">Home</a>
        <span class="breadcrumb-separator">></span>
        <span class="breadcrumb-current">User List</span>
      </nav>

      <!-- Page Title -->
      <h1 class="page-title">User List</h1>

      <!-- Filters Section -->
      <div class="filters-section">
        <div class="search-box">
          <input
            type="text"
            placeholder="Search by username or email..."
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()"
            class="form-input"
          />
        </div>

        <div class="filter-group">
          <select
            id="status-filter"
            [(ngModel)]="selectedStatus"
            (change)="onStatusChange()"
            class="form-select"
          >
            <option value="all">All Status</option>
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
          </select>
        </div>

        <div class="filter-group">
          <select
            id="role-filter"
            [(ngModel)]="selectedRole"
            (change)="onRoleChange()"
            class="form-select"
          >
            <option value="all">All Roles</option>
            <option value="user">User</option>
            <option value="admin">Admin</option>
            <option value="super_admin">Super Admin</option>
          </select>
        </div>

        <div class="filter-group date-range-group">
          <label for="date-from" class="date-label">From:</label>
          <input
            type="date"
            id="date-from"
            [(ngModel)]="dateFrom"
            (change)="onDateRangeChange()"
            class="form-input date-input"
          />
        </div>

        <div class="filter-group date-range-group">
          <label for="date-to" class="date-label">To:</label>
          <input
            type="date"
            id="date-to"
            [(ngModel)]="dateTo"
            (change)="onDateRangeChange()"
            class="form-input date-input"
          />
        </div>

        <div class="filter-group">
          <button
            type="button"
            (click)="clearFilters()"
            class="clear-filters-btn"
            title="Clear All Filters"
          >
            Clear Filters
          </button>
        </div>
      </div>

      <!-- Users Table -->
      <div class="table-container">
        <div *ngIf="isLoading" class="loading">
          <p>Loading users...</p>
        </div>

        <table *ngIf="!isLoading" class="users-table">
          <thead>
            <tr>
              <th>USERNAME</th>
              <th>EMAIL</th>
              <th>ROLE</th>
              <th>STATUS</th>
              <th>CREATED AT</th>
              <th>LAST LOGIN</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of filteredUsers">
              <td class="username-cell">{{ user.name || 'N/A' }}</td>
              <td class="email-cell">{{ user.email }}</td>
              <td>
                <span class="role-badge" [class.role-admin]="user.role === 'admin'" [class.role-super-admin]="user.role === 'super_admin'">
                  {{ user.role | titlecase }}
                </span>
              </td>
              <td>
                <span
                  class="status-badge"
                  [class.status-active]="user.status === 'active'"
                  [class.status-inactive]="user.status === 'inactive'"
                >
                  {{ (user.status || 'active') | titlecase }}
                </span>
              </td>
              <td>{{ formatDate(user.createdAt) }}</td>
              <td>{{ formatDate(user.lastLogin) }}</td>
              <td>
                <div class="action-buttons">
                  <button
                    class="action-btn toggle-status-btn"
                    [class.status-active]="user.status === 'active'"
                    [class.status-inactive]="user.status === 'inactive'"
                    (click)="toggleUserStatus(user)"
                    [title]="user.status === 'active' ? 'Deactivate User' : 'Activate User'"
                  >
                    <span class="status-icon">{{ user.status === 'active' ? '‚úÖ' : '‚ùå' }}</span>
                    {{ user.status === 'active' ? 'Deactivate' : 'Activate' }}
                  </button>
                  <button
                    class="action-btn view-btn"
                    (click)="viewUserLinks(user)"
                    title="View Links"
                  >
                    <span class="action-icon">üîó</span>
                    View Links
                  </button>
                  <button
                    class="action-btn delete-btn"
                    (click)="deleteUser(user)"
                    title="Delete User"
                  >
                    <span class="delete-icon">üóëÔ∏è</span>
                    Delete
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="filteredUsers.length === 0 && !isLoading">
              <td colspan="7" class="no-data">No users found</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination-container" *ngIf="!isLoading && totalUsers > limit">
        <div class="pagination-info">
          Showing {{ (currentPage - 1) * limit + 1 }} to {{ Math.min(currentPage * limit, totalUsers) }} of {{ totalUsers }} users ({{ limit }} per page)
        </div>
        <div class="pagination-controls">
          <button 
            class="pagination-btn" 
            [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)"
            title="Previous Page">
            ‚Üê Previous
          </button>
          <span class="page-info">Page {{ currentPage }} of {{ totalPages }}</span>
          <button 
            class="pagination-btn" 
            [disabled]="currentPage === totalPages"
            (click)="onPageChange(currentPage + 1)"
            title="Next Page">
            Next ‚Üí
          </button>
        </div>
      </div>
    </section>
  </main>
</div>



